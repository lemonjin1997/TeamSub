<!DOCTYPE html>
<html lang="en">
{% include "fragments/header.html" %}
<script type="text/javascript" src="/static/js/otp.js" defer></script>
<script type="text/javascript" src="/static/js/RFC3610_crypto.js" defer></script>

<body>
    <form id="otp-form" class="vh-100" method="POST" action="/otp" style="background-color: #e6eaf0">
        <div class="container h-100">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-xl-9">
                    <h1 class="text-black mb-4">2FA login</h1>
                    {% include "fragments/flash.html" %}
                    <div class="card" style="border-radius: 15px">
                        <div class="card-body">
                            {% if has_otp == False %}
                            <div class="row align-items-center py-3">
                                <div class="col-md-3 ps-5">
                                    <h6 class="mb-0">OTP Registration</h6>
                                </div>
                                <div class="col-md-9 pe-5">
                                    <img id="otp_img" src="data:image/jpeg;base64,{{ img_str }}">
                                </div>
                            </div>
                            <hr class="mx-n3" />
                            {% endif %}
                            <div class="row align-items-center py-3">
                                <div class="col-md-3 ps-5">
                                    <h6 class="mb-0">OTP Code</h6>
                                </div>
                                <div class="col-md-9 pe-5">
                                    <input id="otp" type="password" class="form-control form-control-lg" name="otp" />
                                </div>
                            </div>
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                            <hr class="mx-n3" />
                            <div class="px-5 py-4">
                                <input id="otp-submit" type="button" value="verify" onclick="submitForm();"
                                    class="btn btn-primary btn-lg">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</body>

</html>